<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Recorder 二进制文件格式 - CARLA 模拟器 中文文档</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="../extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Recorder \u4e8c\u8fdb\u5236\u6587\u4ef6\u683c\u5f0f";
        var mkdocs_page_input_path = "ref_recorder_binary_file_format.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> CARLA 模拟器 中文文档
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">主页</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">入门</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../start_introduction/">介绍</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../start_quickstart/">快速启动包安装</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">构建CARLA</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../build_linux/">Linux build</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_windows/">Windows build</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_update/">Update CARLA</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_system/">Build system</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_docker/">CARLA in Docker</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_faq/">F.A.Q.</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">第一步</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../core_concepts/">核心概念</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_world/">第一、 世界和客户端</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_actors/">第二、 角色和蓝图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_map/">第三、地图和导航 </a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_sensors/">第四、 传感器和数据</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">高级概念</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_opendrive/">OpenDRIVE 独立模式</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_ptv/">PTV-Vissim 联合仿真</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_recorder/">Recorder</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_rendering_options/">渲染选项</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_rss/">RSS</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_synchrony_timestep/">同步和时间步长</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_benchmarking/">基准性能</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_agents/">CARLA 代理</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">交通模拟</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ts_traffic_simulation_overview/">交通模拟概述</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_traffic_manager/">Traffic Manager</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_sumo/">SUMO 联合仿真</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_scenic/">Scenic</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">参考</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../python_api/">Python API 参考</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../bp_library/">Blueprint Library</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ref_cpp/">C++ 参考</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Recorder 二进制文件格式</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#1-strings-in-binary">1- Strings in binary</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#2-info-header">2- Info header</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#3-packets">3- Packets</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#packet-0-frame-start">Packet 0 - Frame Start</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#packet-1-frame-end">Packet 1 - Frame End</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#packet-2-event-add">Packet 2 - Event Add</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#packet-3-event-del">Packet 3 - Event Del</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#packet-4-event-parent">Packet 4 - Event Parent</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#packet-5-event-collision">Packet 5 - Event Collision</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#packet-6-position">Packet 6 - Position</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#packet-7-trafficlight">Packet 7 - TrafficLight</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#packet-8-vehicle-animation">Packet 8 - Vehicle animation</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#packet-9-walker-animation">Packet 9 - Walker animation</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#4-frame-layout">4- Frame Layout</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#5-file-layout">5- File Layout</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ref_sensors/">Sensors reference</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">插件</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../plugins_carlaviz/">carlaviz — web 可视化器</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ROS 桥接器</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ros_documentation/">ROS 桥文档</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">自定义地图</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_map_overview/">CARLA 中自定义地图的概述</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_generate_map/">在 RoadRunner 中创建地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_add_map_package/">在CARLA包导入地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_add_map_source/">在 CARLA 源构建中导入地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_add_map_alternative/">导入地图的替代方法</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_manual_map_package/">手动准备地图包</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_layers/">自定义地图：分层地图: Layered maps</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_add_tl/">自定义地图：红绿灯和标志</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_road_painter/">自定义地图：Road painter</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_buildings/">自定义地图：程序建筑</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_weather_landscape/">自定义地图：天气和景观</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_generate_pedestrian_navigation/">生成行人导航</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">大型地图</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../large_map_overview/">大型地图概述</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../large_map_roadrunner/">在RoadRunner中创建大地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../large_map_import/">导入/打包大地图</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">教程（通用）</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_add_friction_triggers/">添加摩擦触发器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_control_vehicle_physics/">控制车辆物理模型</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_control_walker_skeletons/">控制行人骨骼</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_openstreetmap/">使用OpenStreetMap生成地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_retrieve_data/">检索模拟数据</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_carsim_integration/">CarSim 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_rllib_integration/">RLlib 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_chrono/">Chrono 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_docker_unreal/">在 Docker 中构建虚幻引擎UE和 CARLA</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">教程（资产）</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_add_vehicle/">添加新车辆</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_add_props/">添加新道具</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_create_standalone/">创建独立包</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_material_customization/">材料定制</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">教程（开发人员）</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_contribute_assets/">如何升级内容</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_create_sensor/">创建一个传感器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_create_semantic_tags/">创建语义标签</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_customize_vehicle_suspension/">自定义车辆悬架</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_generate_colliders/">生成详细碰撞</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_make_release/">发布版本</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">CARLA 生态系统</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ecosys_ansys/">Ansys 实时雷达模型</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">贡献</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_contribution_guidelines/">贡献指南</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_code_of_conduct/">行为准则</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_coding_standard/">编码标准</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_doc_standard/">文档标准</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">CARLA 模拟器 中文文档</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>参考 &raquo;</li><li>Recorder 二进制文件格式</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>

          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="recorder-binary-file-format">Recorder Binary File Format</h1>
<p>The recorder system saves all the info needed to replay the simulation in a binary file,
using little endian byte order for the multibyte values.</p>
<ul>
<li><a href="#1-strings-in-binary"><strong>1- Strings in binary</strong></a>  </li>
<li><a href="#2-info-header"><strong>2- Info header</strong></a>  </li>
<li><a href="#3-packets"><strong>3- Packets</strong></a>  <ul>
<li><a href="#packet-0-frame-start">Packet 0 - Frame Start</a>  </li>
<li><a href="#packet-1-frame-end">Packet 1 - Frame End</a>  </li>
<li><a href="#packet-2-event-add">Packet 2 - Event Add</a>  </li>
<li><a href="#packet-3-event-del">Packet 3 - Event Del</a>  </li>
<li><a href="#packet-4-event-parent">Packet 4 - Event Parent</a>  </li>
<li><a href="#packet-5-event-collision">Packet 5 - Event Collision</a>  </li>
<li><a href="#packet-6-position">Packet 6 - Position</a>  </li>
<li><a href="#packet-7-trafficlight">Packet 7 - TrafficLight</a>  </li>
<li><a href="#packet-8-vehicle-animation">Packet 8 - Vehicle Animation</a>  </li>
<li><a href="#packet-9-walker-animation">Packet 9 - Walker Animation</a>  </li>
</ul>
</li>
<li><a href="#4-frame-layout"><strong>4- Frame Layout</strong></a>  </li>
<li><a href="#5-file-layout"><strong>5- File Layout</strong></a>  </li>
</ul>
<p>In the next image representing the file format, we can get a quick view of all the detailed
information. Each part that is visualized in the image will be explained in the following sections:</p>
<p><img alt="file format 1" src="../img/RecorderFileFormat1.jpg" /></p>
<p>In summary, the file format has a small header with general info
(version, magic string, date and the map used) and a collection of packets of different types
(currently we use 10 types, but that will continue growing up in the future).</p>
<p><img alt="global file format" src="../img/RecorderFileFormat3.jpg" /></p>
<hr />
<h2 id="1-strings-in-binary">1- Strings in binary</h2>
<p>Strings are encoded first with the length of it, followed by its characters without null
character ending. For example, the string 'Town06' will be saved
as hex values: 06 00 54 6f 77 6e 30 36</p>
<p><img alt="binary dynamic string" src="../img/RecorderString.jpg" /></p>
<hr />
<h2 id="2-info-header">2- Info header</h2>
<p>The info header has general information about the recorded file. Basically, it contains the version
and a magic string to identify the file as a recorder file. If the header changes then the version
will change also. Furthermore, it contains a date timestamp, with the number of seconds from the
Epoch 1900, and also it contains a string with the name of the map that has been used for recording.</p>
<p><img alt="info header" src="../img/RecorderInfoHeader.jpg" /></p>
<p>A sample info header is:</p>
<p><img alt="info header sample" src="../img/RecorderHeader.jpg" /></p>
<hr />
<h2 id="3-packets">3- Packets</h2>
<p>Each packet starts with a little header of two fields (5 bytes):</p>
<p><img alt="packet header" src="../img/RecorderPacketHeader.jpg" /></p>
<ul>
<li><strong>id</strong>: The packet type</li>
<li><strong>size</strong>: Size of packet data</li>
</ul>
<p>Header information is then followed by the <strong>data</strong>.
The <strong>data</strong> is optional, a <strong>size</strong> of 0 means there is no <strong>data</strong> in the packet.
If the <strong>size</strong> is greater than 0 it means that the packet has <strong>data</strong> bytes. Therefore,
the <strong>data</strong> needs to be reinterpreted depending on the type of the packet.</p>
<p>The header of the packet is useful because we can just ignore those packets we are not interested
in when doing playback. We only need to read the header (first 5 bytes) of the packet and jump to
the next packet just skipping the data of the packet:</p>
<p><img alt="packets size" src="../img/RecorderPackets.jpg" /></p>
<p>The types of packets are:</p>
<p><img alt="packets type list" src="../img/RecorderPacketsList.jpg" /></p>
<p>We suggest to use <strong>id</strong> over 100 for user custom packets, because this list will keep growing in
the future.</p>
<h3 id="packet-0-frame-start">Packet 0 - Frame Start</h3>
<p>This packet marks the start of a new frame, and it will be the first one to start each frame.
All packets need to be placed between a <strong>Frame Start</strong> and a <strong>Frame End</strong>.</p>
<p><img alt="frame start" src="../img/RecorderFrameStart.jpg" /></p>
<p>So, elapsed + durationThis = elapsed time for next frame</p>
<h3 id="packet-1-frame-end">Packet 1 - Frame End</h3>
<p>This frame has no data and it only marks the end of the current frame. That helps the replayer
to know the end of each frame just before the new one starts.
Usually, the next frame should be a Frame Start packet to start a new frame.</p>
<p><img alt="frame end" src="../img/RecorderFrameEnd.jpg" /></p>
<h3 id="packet-2-event-add">Packet 2 - Event Add</h3>
<p>This packet says how many actors we need to create at current frame.</p>
<p><img alt="event add" src="../img/RecorderEventAdd.jpg" /></p>
<p>The field <strong>total</strong> says how many records follow. Each record starts with the <strong>id</strong> field,
that is the id the actor has when it was recorded (on playback that id could change internally,
but we need to use this id ). The <strong>type</strong> of actor can have these possible values:</p>
<ul>
<li>0 = Other</li>
<li>1 = Vehicle</li>
<li>2 = Walker</li>
<li>3 = TrafficLight</li>
<li>4 = INVALID</li>
</ul>
<p>After that, the <strong>location</strong> and the <strong>rotation</strong> where we want to create the actor is proceeded.</p>
<p>Right after we have the <strong>description</strong> of the actor. The description <strong>uid</strong> is the numeric id of
the description and the <strong>id</strong> is the textual id, like 'vehicle.seat.leon'.</p>
<p>Then comes a collection of its <strong>attributes</strong> like color, number of wheels, role, etc.
The number of attributes is variable and should look similar to this:</p>
<ul>
<li>number_of_wheels = 4</li>
<li>sticky_control = true</li>
<li>color = 79,33,85</li>
<li>role_name = autopilot</li>
</ul>
<h3 id="packet-3-event-del">Packet 3 - Event Del</h3>
<p>This packet says how many actors need to be destroyed this frame.</p>
<p><img alt="event del" src="../img/RecorderEventDel.jpg" /></p>
<p>It has the <strong>total</strong> of records, and each record has the <strong>id</strong> of the actor to remove.</p>
<p>For example, this packet could be like this:</p>
<p><img alt="event del" src="../img/RecorderPacketSampleEventDel.jpg" /></p>
<p>The number 3 identifies the packet as (Event Del). The number 16 is the size of the data of
the packet (4 fields of 4 bytes each). So if we don't want to process this packet, we could skip
the next 16 bytes and will be directly to the start of the next packet.
The next 3 says the total records that follows, and each record is the id of the actor to remove.
So, we need to remove at this frame the actors 100, 101 and 120.</p>
<h3 id="packet-4-event-parent">Packet 4 - Event Parent</h3>
<p>This packet says which actor is the child of another (the parent).</p>
<p><img alt="event parent" src="../img/RecorderEventParent.jpg" /></p>
<p>The first id is the child actor, and the second one will be the parent actor.</p>
<h3 id="packet-5-event-collision">Packet 5 - Event Collision</h3>
<p>If a collision happens between two actors, it will be registered in this packet. Currently only
actors with a collision sensor will report collisions, so currently only hero vehicles have that
sensor attached automatically.</p>
<p><img alt="event collision" src="../img/RecorderCollision.jpg" /></p>
<p>The <strong>id</strong> is just a sequence to identify each collision internally.
Several collisions between the same pair of actors can happen in the same frame, because physics
frame rate is fixed and usually there are several physics substeps in the same rendered frame.</p>
<h3 id="packet-6-position">Packet 6 - Position</h3>
<p>This packet records the position and orientation of all actors of type <strong>vehicle</strong> and
<strong>walker</strong> that exist in the scene.</p>
<p><img alt="position" src="../img/RecorderPosition.jpg" /></p>
<h3 id="packet-7-trafficlight">Packet 7 - TrafficLight</h3>
<p>This packet records the state of all <strong>traffic lights</strong> in the scene. Which means that it
stores the state (red, orange or green) and the time it is waiting to change to a new state.</p>
<p><img alt="state" src="../img/RecorderTrafficLight.png" /></p>
<h3 id="packet-8-vehicle-animation">Packet 8 - Vehicle animation</h3>
<p>This packet records the animation of the vehicles, bikes and cycles. This packet stores the
<strong>throttle</strong>, <strong>sterring</strong>, <strong>brake</strong>, <strong>handbrake</strong> and <strong>gear</strong> inputs, and then set them at playback.</p>
<p><img alt="state" src="../img/RecorderVehicle.jpg" /></p>
<h3 id="packet-9-walker-animation">Packet 9 - Walker animation</h3>
<p>This packet records the animation of the walker. It just saves the <strong>speed</strong> of the walker
that is used in the animation.</p>
<p><img alt="state" src="../img/RecorderWalker.jpg" /></p>
<hr />
<h2 id="4-frame-layout">4- Frame Layout</h2>
<p>A frame consists of several packets, where all of them are optional, except the ones that
have the <strong>start</strong> and <strong>end</strong> in that frame, that must be there always.</p>
<p><img alt="layout" src="../img/RecorderFrameLayout.jpg" /></p>
<p><strong>Event</strong> packets exist only in the frame where they happen.</p>
<p><strong>Position</strong> and <strong>traffic light</strong> packets should exist in all frames, because they are
required to move all actors and set the traffic lights to its state.
They are optional but if they are not present then the replayer will not be able to move
or set the state of traffic lights.</p>
<p>The <strong>animation</strong> packets are also optional, but by default they are recorded. That way the walkers
are animated and also the vehicle wheels follow the direction of the vehicles.</p>
<hr />
<h2 id="5-file-layout">5- File Layout</h2>
<p>The layout of the file starts with the <strong>info header</strong> and then follows a collection of packets in
groups. The first in each group is the <strong>Frame Start</strong> packet, and the last in the group is
the <strong>Frame End</strong> packet. In between, we can find the rest of packets as well.</p>
<p><img alt="layout" src="../img/RecorderLayout.jpg" /></p>
<p>Usually, it is a good idea to have all packets regarding events first, and then the packets
regarding position and state later.</p>
<p>The event packets are optional, since they appear when they happen, so we could have a layout
like this one:</p>
<p><img alt="layout" src="../img/RecorderLayoutSample.jpg" /></p>
<p>In <strong>frame 1</strong> some actors are created and reparented, so we can observe its events in the image.
In <strong>frame 2</strong> there are no events. In <strong>frame 3</strong> some actors have collided so the collision event
appears with that info. In <strong>frame 4</strong> the actors are destroyed.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../ref_cpp/" class="btn btn-neutral float-left" title="C++ 参考"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../ref_sensors/" class="btn btn-neutral float-right" title="Sensors reference">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../ref_cpp/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../ref_sensors/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../extra.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
