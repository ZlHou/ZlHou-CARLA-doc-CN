<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>导入/打包大地图 - CARLA 模拟器 中文文档</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="../extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "\u5bfc\u5165/\u6253\u5305\u5927\u5730\u56fe";
        var mkdocs_page_input_path = "large_map_import.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> CARLA 模拟器 中文文档
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">主页</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">入门</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../start_introduction/">介绍</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../start_quickstart/">快速启动包安装</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">构建CARLA</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../build_linux/">Linux build</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_windows/">Windows build</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_update/">Update CARLA</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_system/">Build system</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_docker/">CARLA in Docker</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_faq/">F.A.Q.</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">第一步</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../core_concepts/">核心概念</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_world/">第一、 世界和客户端</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_actors/">第二、 角色和蓝图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_map/">第三、地图和导航 </a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_sensors/">第四、 传感器和数据</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">高级概念</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_opendrive/">OpenDRIVE 独立模式</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_ptv/">PTV-Vissim 联合仿真</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_recorder/">Recorder</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_rendering_options/">渲染选项</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_rss/">RSS</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_synchrony_timestep/">同步和时间步长</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_benchmarking/">基准性能</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_agents/">CARLA 代理</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">交通模拟</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ts_traffic_simulation_overview/">交通模拟概述</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_traffic_manager/">Traffic Manager</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_sumo/">SUMO 联合仿真</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_scenic/">Scenic</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">参考</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../python_api/">Python API 参考</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../bp_library/">Blueprint Library</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ref_cpp/">C++ 参考</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ref_recorder_binary_file_format/">Recorder 二进制文件格式</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ref_sensors/">Sensors reference</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">插件</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../plugins_carlaviz/">carlaviz — web 可视化器</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ROS 桥接器</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ros_documentation/">ROS 桥文档</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">自定义地图</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_map_overview/">CARLA 中自定义地图的概述</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_generate_map/">在 RoadRunner 中创建地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_add_map_package/">在CARLA包导入地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_add_map_source/">在 CARLA 源构建中导入地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_add_map_alternative/">导入地图的替代方法</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_manual_map_package/">手动准备地图包</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_layers/">自定义地图：分层地图: Layered maps</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_add_tl/">自定义地图：红绿灯和标志</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_road_painter/">自定义地图：Road painter</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_buildings/">自定义地图：程序建筑</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_weather_landscape/">自定义地图：天气和景观</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_generate_pedestrian_navigation/">生成行人导航</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">大型地图</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../large_map_overview/">大型地图概述</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../large_map_roadrunner/">在RoadRunner中创建大地图</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">导入/打包大地图</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#files-and-folders">Files and folders</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#create-the-json-description-optional">Create the JSON description (Optional)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#making-the-import">Making the import</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#package-a-large-map">Package a large map</a>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">教程（通用）</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_add_friction_triggers/">添加摩擦触发器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_control_vehicle_physics/">控制车辆物理模型</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_control_walker_skeletons/">控制行人骨骼</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_openstreetmap/">使用OpenStreetMap生成地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_retrieve_data/">检索模拟数据</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_carsim_integration/">CarSim 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_rllib_integration/">RLlib 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_chrono/">Chrono 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_docker_unreal/">在 Docker 中构建虚幻引擎UE和 CARLA</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">教程（资产）</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_add_vehicle/">添加新车辆</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_add_props/">添加新道具</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_create_standalone/">创建独立包</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_material_customization/">材料定制</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">教程（开发人员）</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_contribute_assets/">如何升级内容</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_create_sensor/">创建一个传感器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_create_semantic_tags/">创建语义标签</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_customize_vehicle_suspension/">自定义车辆悬架</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_generate_colliders/">生成详细碰撞</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_make_release/">发布版本</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">CARLA 生态系统</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ecosys_ansys/">Ansys 实时雷达模型</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">贡献</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_contribution_guidelines/">贡献指南</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_code_of_conduct/">行为准则</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_coding_standard/">编码标准</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_doc_standard/">文档标准</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">CARLA 模拟器 中文文档</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>大型地图 &raquo;</li><li>导入/打包大地图</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>

          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="importpackage-a-large-map">Import/Package a Large Map</h1>
<p>Large maps generated in RoadRunner can be imported into the source build of CARLA and packaged for distribution and usage in a CARLA standalone package. The process is very simlar to that of standard maps with the addition of specific nomenclature for tiles and batch importing.</p>
<ul>
<li><a href="#files-and-folders"><strong>Files and folders</strong></a></li>
<li><a href="#create-the-json-description-optional"><strong>Create the JSON description (Optional)</strong></a></li>
<li><a href="#making-the-import"><strong>Making the import</strong></a></li>
<li><a href="#package-a-large-map"><strong>Package a large map</strong></a></li>
</ul>
<hr />
<h2 id="files-and-folders">Files and folders</h2>
<p>All files to be imported should be placed in the <code>Import</code> folder of the root CARLA directory. These files should include:</p>
<ul>
<li>The mesh of the map in multiple <code>.fbx</code> files representing different tiles of the map.</li>
<li>The OpenDRIVE definition in a single <code>.xodr</code> file.</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>You cannot import large maps and standard maps at the same time.</p>
</div>
<p>The naming convention of map tiles is very important. Each map tile should be named according to the following convention:</p>
<pre><code>&lt;mapName&gt;_Tile_&lt;x-coordinate&gt;_&lt;y-coordinate&gt;.fbx
</code></pre>
<p>Be aware that a more positive <strong>y coordinate</strong> refers to a tile lower on the y-axis. For example,<code>Map01_Tile_0_1</code> would sit just below <code>Map01_Tile_0_0</code>. </p>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<p><img alt="map_tiles" src="../img/map_tiles.png" /></p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<p>A resulting <code>Import</code> folder with a package containing a large map made of four tiles should have a structure similar to the one below:</p>
<pre><code class="language-sh">Import
│
└── Package01
  ├── Package01.json
  ├── Map01_Tile_0_0.fbx
  ├── Map01_Tile_0_1.fbx
  ├── Map01_Tile_1_0.fbx
  ├── Map01_Tile_1_1.fbx
  └── Map01.xodr

</code></pre>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code>package.json</code> file is not strictly necessary. If there is no <code>package.json</code> file created, the automated import process will create one. Find out more about to structure your own <code>package.json</code> in the next section.</p>
</div>
<hr />
<h2 id="create-the-json-description-optional">Create the JSON description (Optional)</h2>
<p>The <code>.json</code> description is created automatically during the import process, but there is also the option to create one manually. An existing <code>.json</code> description will override any values passed as arguments in the import process.</p>
<p>The <code>.json</code> file should be created in the root folder of the package. The file name will be the package distribution name. The content of the file describes a JSON array of <strong>maps</strong> and <strong>props</strong> with basic information for each one.</p>
<p><strong>Maps</strong> need the following parameters:</p>
<ul>
<li><strong>name:</strong> Name of the map. This must be the same as the <code>.fbx</code> and <code>.xodr</code> files.</li>
<li><strong>xodr:</strong> Path to the <code>.xodr</code> file.</li>
<li><strong>use_carla_materials:</strong> If <strong>True</strong>, the map will use CARLA materials. Otherwise, it will use RoadRunner materials.</li>
<li><strong>tile_size:</strong> The size of the tiles. Default value is 2000 (2kmx2km).</li>
<li><strong>tiles:</strong> A list of the <code>.fbx</code> tile files that make up the entire map.</li>
</ul>
<p><strong>Props</strong> are not part of this tutorial. Please see <a href="../tuto_A_add_props/">this</a> tutorial for how to add new props.</p>
<p>The resulting <code>.json</code> file should resemble the following:</p>
<pre><code class="language-json">{
  &quot;maps&quot;: [
      {
        &quot;name&quot;: &quot;Map01&quot;,
        &quot;xodr&quot;: &quot;./Map01.xodr&quot;,
        &quot;use_carla_materials&quot;: true,
        &quot;tile_size&quot;: 2000,
        &quot;tiles&quot;: [ 
        &quot;./Map01_Tile_0_0.fbx&quot;,
        &quot;./Map01_Tile_0_1.fbx&quot;,
        &quot;./Map01_Tile_1_0.fbx&quot;,
        &quot;./Map01_Tile_1_1.fbx&quot;
        ]
      }
  ],
  &quot;props&quot;: []
}
</code></pre>
<p></details>
<br></p>
<hr />
<h2 id="making-the-import">Making the import</h2>
<p>When all files have been placed in the <code>Import</code> folder, run the following command in the root CARLA folder:</p>
<pre><code class="language-sh">make import
</code></pre>
<p>Depending on your system, Unreal Engine may consume too much memory to be able to import all files at once. You can choose to import the files in batches of MB by running the command:</p>
<pre><code class="language-sh">make import ARGS=&quot;--batch-size=200&quot;
</code></pre>
<p>Two more flags exist for the <code>make import</code> command:</p>
<ul>
<li><code>--package=&lt;package_name&gt;</code> specifies the name of the package. By default, this is set to <code>map_package</code>. Two packages cannot have the same name, so using the default value will lead to errors on a subsequent ingestion. <strong>It is highly recommended to change the name of the package</strong>. Use this flag by running the command:</li>
</ul>
<pre><code class="language-sh">make import  ARGS=&quot;--package=&lt;package_name&gt;&quot;
</code></pre>
<ul>
<li><code>--no-carla-materials</code> specifies that you do not want to use the default CARLA materials (road textures etc). You will use the RoadRunner materials instead. This flag is <strong>only required if you are not</strong> providing your own <a href="../tuto_M_manual_map_package/"><code>.json</code> file</a>. Any value in the <code>.json</code> file will override this flag. Use this flag by running the command:</li>
</ul>
<pre><code class="language-sh">make import  ARGS=&quot;--no-carla-materials&quot;
</code></pre>
<p>All files will be imported and prepared to be used in the Unreal Editor. The map package will be created in <code>Unreal/CarlaUE4/Content</code>. A base map tile, <code>&lt;mapName&gt;</code>, will be created as a streaming level for all the tiles. The base tile will contain the sky, weather, and large map actors and will be ready for use in a simulation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is currently not recommended to use the customization tools provided for standard maps in the Unreal Editor, e.g., road painter, procedural buildings, etc.</p>
</div>
<hr />
<h2 id="package-a-large-map">Package a large map</h2>
<p>To package your large map so it can be used in the CARLA standalone package, run the following command:</p>
<pre><code class="language-sh">make package ARGS=&quot;--packages=&lt;mapPackage&gt;&quot;
</code></pre>
<p>This will create a standalone package compressed in a <code>.tar.gz</code> file. The files will be saved in the <code>Dist</code> folder on Linux, and <code>/Build/UE4Carla/</code> on Windows. They can then be distributed and packaged to use in standalone CARLA packages.</p>
<hr />
<p>If you have any questions about the large map import and packaging process, then you can ask in the <a href="https://github.com/carla-simulator/carla/discussions">forum</a>.</p>
<div class="build-buttons">
<p>
<a href="https://github.com/carla-simulator/carla/discussions" target="_blank" class="btn btn-neutral" title="Go to the CARLA forum">
CARLA forum</a>
</p>
</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../large_map_roadrunner/" class="btn btn-neutral float-left" title="在RoadRunner中创建大地图"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../tuto_G_add_friction_triggers/" class="btn btn-neutral float-right" title="添加摩擦触发器">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../large_map_roadrunner/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../tuto_G_add_friction_triggers/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../extra.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
